---
category: manual
section: documentation
subsection: manual
title: Git - git-sh-setup Documentation
docname: git-sh-setup
lang: zh_HANS-CN
aliases:
- "/docs/git-sh-setup/zh_HANS-CN/index.html"

---
<div class="sect1">
<h2 id="_名称"><a class="anchor" href="#_名称"></a>名称</h2>
<div class="sectionbody">
<div class="paragraph">
<p>git-sh-setup - Common Git shell script setup code</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_概述"><a class="anchor" href="#_概述"></a>概述</h2>
<div class="sectionbody">
<div class="verseblock">
<pre class="content"><em>. "$(git --exec-path)/git-sh-setup"</em></pre>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_描述"><a class="anchor" href="#_描述"></a>描述</h2>
<div class="sectionbody">
<div class="paragraph">
<p>这不是一个终端用户想要运行的命令。 永远不会。 这个文档是为研究 Porcelain-ish 脚本和/或正在编写新脚本的人准备的。</p>
</div>
<div class="paragraph">
<p>The <em>git sh-setup</em> scriptlet is designed to be sourced (using <code>.</code>) by other shell scripts to set up some variables pointing at the normal Git directories and a few helper shell functions.</p>
</div>
<div class="paragraph">
<p>Before sourcing it, your script should set up a few variables; <code>USAGE</code> (and <code>LONG_USAGE</code>, if any) is used to define the message given by <code>usage()</code> shell function. <code>SUBDIRECTORY_OK</code> can be set if the script can run from a subdirectory of the working tree (some commands do not).</p>
</div>
<div class="paragraph">
<p>脚本小程序会设置 <code>GIT_DIR</code> 和 <code>GIT_OBJECT_DIRECTORY</code> shell 变量，但*不会*导出它们到环境中。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_functions"><a class="anchor" href="#_functions"></a>FUNCTIONS</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1" id="git-sh-setup-die"> <a class="anchor" href="#git-sh-setup-die"></a>die </dt>
<dd>
<p>将提供的错误信息发送到标准错误流后退出。</p>
</dd>
<dt class="hdlist1" id="git-sh-setup-usage"> <a class="anchor" href="#git-sh-setup-usage"></a>usage </dt>
<dd>
<p>结束，并显示使用信息。</p>
</dd>
<dt class="hdlist1" id="git-sh-setup-setreflogaction"> <a class="anchor" href="#git-sh-setup-setreflogaction"></a>set_reflog_action </dt>
<dd>
<p>将 <code>GIT_REFLOG_ACTION</code> 环境设置为给定的字符串（通常是程序名称），除非它已经被设置。 每当脚本运行更新引用的 <code>git</code> 命令时，就会使用该字符串的值创建一个引用日志条目，以记录更新引用的命令。</p>
</dd>
<dt class="hdlist1" id="git-sh-setup-giteditor"> <a class="anchor" href="#git-sh-setup-giteditor"></a>git_editor </dt>
<dd>
<p>在给定文件上运行用户选择的编辑器（GIT_EDITOR、core.editor、VISUAL 或 EDITOR），但如果未指定编辑器且终端为哑终端，则会出错。</p>
</dd>
<dt class="hdlist1" id="git-sh-setup-isbarerepository"> <a class="anchor" href="#git-sh-setup-isbarerepository"></a>is_bare_repository </dt>
<dd>
<p>会向标准输出流输出 <code>true</code> 或 <code>false</code>，以指示版本库是否为裸仓库（即没有任何关联的工作区）。</p>
</dd>
<dt class="hdlist1" id="git-sh-setup-cdtotoplevel"> <a class="anchor" href="#git-sh-setup-cdtotoplevel"></a>cd_to_toplevel </dt>
<dd>
<p>运行 chdir 到工作树的顶层。</p>
</dd>
<dt class="hdlist1" id="git-sh-setup-requireworktree"> <a class="anchor" href="#git-sh-setup-requireworktree"></a>require_work_tree </dt>
<dd>
<p>会检查当前目录是否在仓库的工作区中，否则就挂起。</p>
</dd>
<dt class="hdlist1" id="git-sh-setup-requireworktreeexists"> <a class="anchor" href="#git-sh-setup-requireworktreeexists"></a>require_work_tree_exists </dt>
<dd>
<p>检查与仓库相关联的工作区是否存在，否则挂掉。 通常在调用 cd_to_toplevel 之前进行，如果没有工作区，就不可能调用 cd_to_toplevel。</p>
</dd>
<dt class="hdlist1" id="git-sh-setup-requirecleanworktreeltgtltgt"> <a class="anchor" href="#git-sh-setup-requirecleanworktreeltgtltgt"></a>require_clean_work_tree &lt;行为&gt; [&lt;提示&gt;] </dt>
<dd>
<p>会检查与仓库关联的工作区和索引中是否有未提交的跟踪文件变更。 否则，它将发出 "无法执行 &lt;行为&gt;:&lt;原因&gt;. &lt;提示&gt;"，然后挂掉。例如：</p>
<div class="listingblock">
<div class="content">
<pre>require_clean_work_tree rebase "请提交或者贮藏他们。"</pre>
</div>
</div>
</dd>
<dt class="hdlist1" id="git-sh-setup-getauthoridentfromcommit"> <a class="anchor" href="#git-sh-setup-getauthoridentfromcommit"></a>get_author_ident_from_commit </dt>
<dd>
<p>输出与 eval 配合使用的代码，以设置指定提交的 GIT_AUTHOR_NAME、GIT_AUTHOR_EMAIL 和 GIT_AUTHOR_DATE 变量。</p>
</dd>
<dt class="hdlist1" id="git-sh-setup-createvirtualbase"> <a class="anchor" href="#git-sh-setup-createvirtualbase"></a>create_virtual_base </dt>
<dd>
<p>修改第一个文件，只保留与第二个文件相同的行。如果共同内容不足，则第一个文件留空。结果适合作为三向合并的虚拟基础输入。</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_git"><a class="anchor" href="#_git"></a>GIT</h2>
<div class="sectionbody">
<div class="paragraph">
<p>属于 <a href='{{< relurl "docs/git/zh_HANS-CN" >}}'>git[1]</a> 文档</p>
</div>
</div>
</div>